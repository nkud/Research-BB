#+TITLE: 宿主内動態組込型ABM ver1.3
#+AUTHOR: Naoki Ueda
#+OPTIONS: \n:t H:1 toc:t creator:nil num:nil author:nil email:nil timestamp:nil
#+LANGUAGE: ja
#+LaTeX_CLASS: normal
#+STARTUP: content
#+HTML_HEAD: <style type="text/css">body {font-family:"verdana";font-size:0.8em;}</style>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="report.css" />

* COMMENT キーワード・疑問点

** evolutionary invation analysis

** Figure Caption

** 細胞の受容体と、T細胞の受容体は別？同じなら、ウイルスの淘汰といろいろ関連性が生まれてくる
* COMMENT 前回セミナーの内容

** Invasion Fitnessについて調べる。

** Figure Captionについて調べるとよい。

** 一部に、周期的なグラフが現れる点について。

*** その前後で、なにかが変化しているのではないか。

* COMMENT TODO

** Figure Captionを印刷して読む
* COMMENT 変更点・進歩状況
** Invasion Fitness
* モデルの変更点
** 細胞に遺伝子を持たせた
*** ウイルスは、自身と細胞の遺伝子を見比べて、 *感染率* を決める
**** 遺伝子によって、感染率が異なることになる。
*** ウイルスの種類によって、異なるヒトの部位に取り付く特性を、表現するため。
**** 例：インフルエンザ　→　咽喉部
* 実験
** 初期設定
| 項目               |  数値 | 備考                                                               |
|--------------------+-------+--------------------------------------------------------------------|
| 最大実行期間       | 10000 |                                                                    |
| 初期ヒト数         |     1 |                                                                    |
|--------------------+-------+--------------------------------------------------------------------|
| 最大保持ウイルス数 |   100 |                                                                    |
| 細胞土地ヨコ       |    30 |                                                                    |
| 細胞土地タテ       |    30 |                                                                    |
|--------------------+-------+--------------------------------------------------------------------|
| T細胞遺伝子長      |     5 |                                                                    |
| 最小T細胞数        |   100 | T細胞の最低総数。足りない分は、ランダムな遺伝子で補完される。      |
| T細胞寿命          |    30 |                                                                    |
| 記憶率(%)          |    10 | 分裂したT細胞はこの確率で、寿命無効となる。                        |
| クローン数         |     3 | T細胞がウイルスを除去した時に分裂する数(1→4)                       |
|--------------------+-------+--------------------------------------------------------------------|
| ウイルス遺伝子長   |     5 |                                                                    |
| 増殖率(%)          |    80 | 細胞内での増殖率                                                   |
| 突然変異率(%)      |    30 | ウイルスの突然変異。点突然変異のみする。                           |
| 一段階増殖閾値(%)  |    30 | 細胞内ウイルス密度がこの値を超えると、近隣細胞に感染する能力を持つ |
** 細胞の遺伝子
*** "0000000000"
** ウイルスの近隣細胞への感染率の決め方
*** (100 - _(最小ハミング距離/ウイルスの遺伝子長)×100_ )％
**** ウイルスと細胞の遺伝子の最小ハミング距離が０なら、１００％
**** *この実験の場合、ウイルスの評価値が高ければ、感染率は下がる。* (細胞の遺伝子は０のみの配列なので。)
* 結果
#+CAPTION: ヒト(No.0)の感染細胞数 / 全細胞数
[[file:result-141004-200623-notitle/stat/density.png]]
: たとえ感染細胞が大きく取り除かれたとしても、
: まわりに感染細胞があるので、すぐに感染してしまう。

#+CAPTION: ヒト(No.0)の全T細胞数
[[file:result-141004-200623-notitle/stat/tcell-size.png]]
: メモリーT細胞が徐々に増えるので、
: 総数が増えていっている。

#+CAPTION: ヒト(No.0)内で一定期間内に新しく増殖したウイルスの平均遺伝子評価値
[[file:result-141004-200623-notitle/stat/ave-newvirus.png]]
: はじめのウイルス平均評価値は、２(この計算では、ウイルス遺伝子"10001"がはじめのタグ)。
: 広がるたびに、T細胞に取り除かれるので、感染力の強いウイルスは最初に取り除かれ、
: 結果、ウイルスの平均遺伝子が伸びている。

#+CAPTION: ヒト(No.0)が保持する全ウイルス数
[[file:result-141004-200623-notitle/stat/virus-size.png]]
: ウイルスの感染する速度が徐々に遅くなっている。
: ウイルスの平均遺伝子が上がっているので、
: 同時に細胞への感染率も低下する。 （細胞のタグは"000..."）


* 結果に対する考察

** 宿主内ウイルス密度がほぼ１００％から減らない場合の結果について。

*** 計算の後半で、T細胞により感染細胞が除去され未感染細胞に戻ったとしても、周りの感染細胞から即座に感染することで、またすぐ感染細胞になってしまうからと考えられる。

** ウイルスの評価値の分布について

*** 図３のウイルスの評価値の分布を、100期間ごとに出力した。

*** 結果の一部 *(上から、1000/2000/3000/.../10000 期間目の分布)*
ヨコ軸：評価値
タテ軸：評価値に対応した、その日に新しく増殖したウイルスの数
[[file:result-141004-200623-notitle/1000_vvm.png]]
[[file:result-141004-200623-notitle/2000_vvm.png]]
[[file:result-141004-200623-notitle/3000_vvm.png]]
[[file:result-141004-200623-notitle/4000_vvm.png]]
[[file:result-141004-200623-notitle/5000_vvm.png]]
[[file:result-141004-200623-notitle/6000_vvm.png]]
[[file:result-141004-200623-notitle/7000_vvm.png]]
[[file:result-141004-200623-notitle/8000_vvm.png]]
[[file:result-141004-200623-notitle/9000_vvm.png]]
[[file:result-141004-200623-notitle/10000_vvm.png]]

*** *上の矢印のように、5000期間目の分布で、今までとは異なった系統のウイルスが出現しているのが分かる。*

**** 通常なら、ウイルスの評価値は０に近づくはず。
そのほうが感染率は高いので。

**** このまま計算すると、感染率が徐々に下がっていくのではないか。
* 現モデルの問題点

** ヒトは、ウイルスの感染が抑えきれなくなり、症候性期間が長期間続いたとしても、死亡などしてRecover/Removeされるという遷移は組み込まれていない。

* 現モデルによる計算の流れ（宿主内動態）
1) T細胞の移動
   1) T細胞が細胞土地の上を移動する。
2) 細胞の接触
   1) 各細胞に対して近隣の細胞を取得し、
   2) 各近隣に対して、 その近隣の細胞内ウイルス密度が閾値を超えていれば、
   3) その近隣のウイルスを、自分の待機ウイルスに加える。
3) 細胞の感染
   1) 各細胞に対して
   2) 自分の待機ウイルスの内から１つランダムに選び、
   3) *そのウイルスの自身に対する固有の感染率で、*
   4) 自分に感染させる。
4) T細胞による殺傷
   1) 各T細胞に対して、T細胞が、
   2) 同じ位置にある細胞の感染ウイルスのタグを含んでいれば、
   3) 細胞内ウイルス密度に比例した確率で、（最大なら100%）
   4) ウイルスを除去する。
      1) 同じタグを持つT細胞をその位置で複製する。
         1) 指定された記憶率の確率で、
         2) 複製したT細胞をメモリーT細胞にする。
            (寿命がなくなる)
5) T細胞の寿命
   1) 各T細胞に対して、
   2) １つ年齢を増やし、
   3) メモリーT細胞でなければ、
   4) 寿命を超えていれば、
   5) 宿主内のT細胞リストから除去される
6) ウイルスの増殖
   1) 各細胞に対して、
   2) 感染細胞ならば、
   3) 最大保持ウイルスを超えていなければ、
   4) 指定されたウイルス増殖率で、
   5) 保持しているウイルスをクローンして１つ増やす。
      1) その際、初期に設定された確率で、
      2) 突然変異を起こす
         1) タグの中からランダムに位置を選び、
         2) 値を変える。

* 補足

** メモリーT細胞の寿命無効化について

*** 実際、メモリーT細胞は長命である

**** 過去に天然痘に感染した人が、撲滅宣言の後数十年後に調べたところまだ免疫が残っていた例がある。

***** /記憶率の確率でT細胞が、寿命を無効化（メモリーT細胞化）するのは妥当。/
* COMMENT graphviz
#+begin_dot dot_example.png -Tpng
digraph sample {
node [shape=box, width=1];
a [label="Node A"];
b [label="Node B"];
c [label="Node C"];
d [label="Node D"];
a -> b [label=" A-B "];
b -> c [label=" B-C "];
d -> c [label=" C-D ", dir=back];
a -> d [style=dashed];
{rank=same; a; b}
{rank=same; c; d}
}
#+end_dot
